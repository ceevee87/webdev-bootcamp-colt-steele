<% include partials/header %>
<div class="container">
    <div class="row">
        <div class="col-md-3">
            <p class="lead">YelpCamp</p>
            <div class="list-group">
                <li class="list-group-item active">Item 1</li>
                <li class="list-group-item">Item 2</li>
                <li class="list-group-item">Item 3</li>
            </div>
        </div>
        <div class="col-md-9">
            <div class="campground-show-img-thumbnail thumbnail">
                <image class="campground-img img-responsive" src="<%= campground.image%>">
                <div class="campground-caption caption-full">
                    <h4 class="pull-right">$9.00/night</h4>
                    <h4><%= campground.name %></h4>
                    <p><%=campground.description%></p>
                    <%if (campground.author && campground.author.username) { %>
                    <p>
                        <em>Submitted by <%=campground.author.username%></em>
                    </p>
                    <%} %>
                    <!--middleware protects campgrounds from being edited or deleted by someone
                    other than the owner. nonetheless, I won't display the buttons
                    to perform these actions if the user is not the campground owner.
                    it just makes for a better user experience. -->
                    <%if (currentUser && campground.author && campground.author.id && campground.author.id.equals(currentUser._id)) { %>
                        <a class="btn btn-xs btn-warning" href="/campgrounds/<%=campground._id%>/edit">Edit</a>
                        <form class="inline-form-button" 
                                action="/campgrounds/<%=campground._id%>?_method=DELETE" method="POST">
                            <button class="btn btn-xs btn-danger">Delete</button>
                        </form>
                    <%} %>
                </div>
            </div>
            <div class="well">
                <div class="text-right">
                    <a href="/campgrounds/<%=campground._id%>/comments/new" class="btn btn-success">Add a Comment</a>
                </div>
                <hr>
                <% campground.comments.forEach(function(comment) { %>
                    <div class="comment-list row">
                        <div class="col-md-12">
                            <strong><%=comment.author.username%></strong>
                            <%if (currentUser && comment.author && comment.author.id && comment.author.id.equals(currentUser._id)) { %>
                                <!--edit this comment-->
                                <span><a class="btn btn-xs" 
                                    href="/campgrounds/<%=campground._id%>/comments/<%=comment._id%>/edit">
                                    <i class="fa fa-pencil fa-lg"></i></a>
                                </span>

                                <!--delete the comment-->
                                <!--we are NOT using method override here because the delete-->
                                <!--action is going to be handled with AJAX.-->
                                <form class="form-delete-comment inline-form-button" 
                                        action="/campgrounds/<%=campground._id%>/comments/<%=comment._id%>" 
                                        method="POST">
                                    <button type="submit" id="completed-task" class="fabutton">
                                        <i class="fa fa-lg fa-trash-o" aria-hidden="true"></i>
                                    </button>
                                </form>

                            <%} %>
                            <span class="pull-right">10 days ago</span>
                            <p><%=comment.text%></p>
                        </div>
                    </div>
                <%});%>
            </div>
        </div>
    </div>
<h1></h1>

</div>
<% include partials/footer %>
